{
  "sqlfluff__sqlfluff-1625": {
    "model_name_or_path": "anthropic/claude-sonnet-4-20250514",
    "instance_id": "sqlfluff__sqlfluff-1625",
    "model_patch": "diff --git a/src/sqlfluff/rules/L031.py b/src/sqlfluff/rules/L031.py\nindex 838c6ce5d..4fd082eb7 100644\n--- a/src/sqlfluff/rules/L031.py\n+++ b/src/sqlfluff/rules/L031.py\n@@ -62,6 +62,12 @@ class Rule_L031(BaseRule):\n             if not from_clause_segment:\n                 return None\n \n+            # Only flag aliases if there are actual JOIN clauses\n+            # Check if there are any join clauses in the statement\n+            has_joins = list(from_clause_segment.recursive_crawl(\"join_clause\"))\n+            if not has_joins:\n+                return None\n+\n             from_expression = from_clause_segment.get_child(\"from_expression\")\n             from_expression_element = None\n             if from_expression:\n@@ -217,3 +223,4 @@ class Rule_L031(BaseRule):\n             )\n \n         return violation_buff or None\n+\ndiff --git a/test/fixtures/rules/std_rule_cases/L031.yml b/test/fixtures/rules/std_rule_cases/L031.yml\nindex 40b41639a..a2947cdec 100644\n--- a/test/fixtures/rules/std_rule_cases/L031.yml\n+++ b/test/fixtures/rules/std_rule_cases/L031.yml\n@@ -79,12 +79,10 @@ test_fail_avoid_aliases_3:\n     order by o desc\n \n alias_single_char_identifiers:\n-  fail_str: \"select b from tbl as a\"\n-  fix_str: \"select b from tbl\"\n+  pass_str: \"select b from tbl as a\"\n \n alias_with_wildcard_identifier:\n-  fail_str: \"select * from tbl as a\"\n-  fix_str: \"select * from tbl\"\n+  pass_str: \"select * from tbl as a\"\n \n select_from_values:\n   pass_str: |\n@@ -168,3 +166,4 @@ issue_1589:\n               rnd>=t.v\n          order by rnd\n          limit 1)\n+\n"
  },
  "sqlfluff__sqlfluff-2419": {
    "model_name_or_path": "anthropic/claude-sonnet-4-20250514",
    "instance_id": "sqlfluff__sqlfluff-2419",
    "model_patch": "diff --git a/src/sqlfluff/rules/L060.py b/src/sqlfluff/rules/L060.py\nindex 836941edc..41ea0187a 100644\n--- a/src/sqlfluff/rules/L060.py\n+++ b/src/sqlfluff/rules/L060.py\n@@ -59,4 +59,9 @@ class Rule_L060(BaseRule):\n             ],\n         )\n \n-        return LintResult(context.segment, [fix])\n+        return LintResult(\n+            context.segment,\n+            [fix],\n+            description=f\"Use 'COALESCE' instead of '{context.segment.raw_upper}'.\",\n+        )\n+\n"
  },
  "sqlfluff__sqlfluff-1733": {
    "model_name_or_path": "anthropic/claude-sonnet-4-20250514",
    "instance_id": "sqlfluff__sqlfluff-1733",
    "model_patch": "diff --git a/src/sqlfluff/rules/L036.py b/src/sqlfluff/rules/L036.py\nindex ed5533b81..39d8c9be0 100644\n--- a/src/sqlfluff/rules/L036.py\n+++ b/src/sqlfluff/rules/L036.py\n@@ -115,7 +115,7 @@ class Rule_L036(BaseRule):\n                     if not i\n                     else select_targets_info.select_targets[i - 1],\n                     select_if=lambda s: s.is_type(\"whitespace\"),\n-                    loop_while=lambda s: s.is_type(\"whitespace\", \"comma\") or s.is_meta,\n+                    loop_while=lambda s: s.is_type(\"whitespace\", \"comma\") or (s.is_meta and not s.is_type(\"indent\")),\n                 )\n                 fixes += [LintFix(\"delete\", ws) for ws in ws_to_delete]\n                 fixes.append(LintFix(\"create\", select_target, NewlineSegment()))\n@@ -335,3 +335,4 @@ class Rule_L036(BaseRule):\n             )\n         else:\n             return None\n+\n"
  },
  "sqlfluff__sqlfluff-1517": {
    "model_name_or_path": "anthropic/claude-sonnet-4-20250514",
    "instance_id": "sqlfluff__sqlfluff-1517",
    "model_patch": ""
  },
  "sqlfluff__sqlfluff-1763": {
    "model_name_or_path": "anthropic/claude-sonnet-4-20250514",
    "instance_id": "sqlfluff__sqlfluff-1763",
    "model_patch": ""
  },
  "marshmallow-code__marshmallow-1359": {
    "model_name_or_path": "anthropic/claude-sonnet-4-20250514",
    "instance_id": "marshmallow-code__marshmallow-1359",
    "model_patch": "diff --git a/src/marshmallow/fields.py b/src/marshmallow/fields.py\nindex 0b18e7dd..320affe1 100644\n--- a/src/marshmallow/fields.py\n+++ b/src/marshmallow/fields.py\n@@ -1112,11 +1112,14 @@ class DateTime(Field):\n \n     def _bind_to_schema(self, field_name, schema):\n         super()._bind_to_schema(field_name, schema)\n-        self.format = (\n-            self.format\n-            or getattr(schema.opts, self.SCHEMA_OPTS_VAR_NAME)\n-            or self.DEFAULT_FORMAT\n-        )\n+        if isinstance(schema, SchemaABC):\n+            self.format = (\n+                self.format\n+                or getattr(schema.opts, self.SCHEMA_OPTS_VAR_NAME)\n+                or self.DEFAULT_FORMAT\n+            )\n+        else:\n+            self.format = self.format or self.DEFAULT_FORMAT\n \n     def _serialize(self, value, attr, obj, **kwargs):\n         if value is None:\n@@ -1691,3 +1694,4 @@ URL = Url\n Str = String\n Bool = Boolean\n Int = Integer\n+\n"
  },
  "marshmallow-code__marshmallow-1343": {
    "model_name_or_path": "anthropic/claude-sonnet-4-20250514",
    "instance_id": "marshmallow-code__marshmallow-1343",
    "model_patch": "diff --git a/src/marshmallow/marshalling.py b/src/marshmallow/marshalling.py\nindex feb7d1aa..c36dbdde 100644\n--- a/src/marshmallow/marshalling.py\n+++ b/src/marshmallow/marshalling.py\n@@ -13,7 +13,7 @@ from __future__ import unicode_literals\n import collections\n \n from marshmallow.utils import is_collection, missing, set_value\n-from marshmallow.compat import text_type, iteritems\n+from marshmallow.compat import text_type, iteritems, Mapping\n from marshmallow.exceptions import (\n     ValidationError,\n )\n@@ -250,7 +250,7 @@ class Unmarshaller(ErrorStore):\n \n         ret = dict_class()\n \n-        if not isinstance(data, collections.Mapping):\n+        if not isinstance(data, Mapping):\n             errors = self.get_errors(index=index)\n             msg = 'Invalid input type.'\n             self.error_field_names = [SCHEMA]\n@@ -306,3 +306,5 @@ class Unmarshaller(ErrorStore):\n \n     # Make an instance callable\n     __call__ = deserialize\n+\n+\ndiff --git a/src/marshmallow/schema.py b/src/marshmallow/schema.py\nindex 085c509b..b150b253 100644\n--- a/src/marshmallow/schema.py\n+++ b/src/marshmallow/schema.py\n@@ -671,7 +671,8 @@ class BaseSchema(base.SchemaABC):\n                 )\n             except ValidationError as error:\n                 result = error.data\n-            self._invoke_field_validators(unmarshal, data=result, many=many)\n+            if result is not None:\n+                self._invoke_field_validators(unmarshal, data=result, many=many)\n             errors = unmarshal.errors\n             field_errors = bool(errors)\n             # Run schema-level migration\n@@ -875,6 +876,9 @@ class BaseSchema(base.SchemaABC):\n \n             if many:\n                 for idx, item in enumerate(data):\n+                    # Skip if item is None (e.g., when validation failed for a nested field)\n+                    if item is None:\n+                        continue\n                     try:\n                         value = item[field_obj.attribute or field_name]\n                     except KeyError:\n@@ -890,6 +894,9 @@ class BaseSchema(base.SchemaABC):\n                         if validated_value is missing:\n                             data[idx].pop(field_name, None)\n             else:\n+                # Skip if data is None (e.g., when validation failed for a nested field)\n+                if data is None:\n+                    continue\n                 try:\n                     value = data[field_obj.attribute or field_name]\n                 except KeyError:\n@@ -966,3 +973,5 @@ class BaseSchema(base.SchemaABC):\n \n class Schema(with_metaclass(SchemaMeta, BaseSchema)):\n     __doc__ = BaseSchema.__doc__\n+\n+\n"
  },
  "pvlib__pvlib-python-1707": {
    "model_name_or_path": "anthropic/claude-sonnet-4-20250514",
    "instance_id": "pvlib__pvlib-python-1707",
    "model_patch": "diff --git a/pvlib/iam.py b/pvlib/iam.py\nindex 3eaa6b4..b3703d5 100644\n--- a/pvlib/iam.py\n+++ b/pvlib/iam.py\n@@ -175,8 +175,12 @@ def physical(aoi, n=1.526, K=4.0, L=0.002, *, n_ar=None):\n     n2costheta2 = n2 * costheta\n \n     # reflectance of s-, p-polarized, and normal light by the first interface\n-    rho12_s = ((n1costheta1 - n2costheta2) / (n1costheta1 + n2costheta2)) ** 2\n-    rho12_p = ((n1costheta2 - n2costheta1) / (n1costheta2 + n2costheta1)) ** 2\n+    with np.errstate(divide='ignore', invalid='ignore'):\n+        rho12_s = \\\n+            ((n1costheta1 - n2costheta2) / (n1costheta1 + n2costheta2)) ** 2\n+        rho12_p = \\\n+            ((n1costheta2 - n2costheta1) / (n1costheta2 + n2costheta1)) ** 2\n+\n     rho12_0 = ((n1 - n2) / (n1 + n2)) ** 2\n \n     # transmittance through the first interface\n@@ -197,7 +201,7 @@ def physical(aoi, n=1.526, K=4.0, L=0.002, *, n_ar=None):\n             (n2costheta2 - n3costheta3) / (n2costheta2 + n3costheta3)\n         ) ** 2\n         rho23_p = (\n-            (n2costheta3 - n3costheta2) / (n2costheta3 + n3costheta2)\n+            (n3costheta3 - n2costheta2) / (n3costheta3 + n2costheta2)\n         ) ** 2\n         rho23_0 = ((n2 - n3) / (n2 + n3)) ** 2\n \n@@ -208,15 +212,23 @@ def physical(aoi, n=1.526, K=4.0, L=0.002, *, n_ar=None):\n         tau_0 *= (1 - rho23_0) / (1 - rho23_0 * rho12_0)\n \n     # transmittance after absorption in the glass\n-    tau_s *= np.exp(-K * L / costheta)\n-    tau_p *= np.exp(-K * L / costheta)\n+    with np.errstate(divide='ignore', invalid='ignore'):\n+        tau_s *= np.exp(-K * L / costheta)\n+        tau_p *= np.exp(-K * L / costheta)\n+\n     tau_0 *= np.exp(-K * L)\n \n     # incidence angle modifier\n     iam = (tau_s + tau_p) / 2 / tau_0\n \n-    return iam\n+    # for light coming from behind the plane, none can enter the module\n+    # when n2 > 1, this is already the case\n+    if np.isclose(n2, 1).any():\n+        iam = np.where(aoi >= 90, 0, iam)\n+        if isinstance(aoi, pd.Series):\n+            iam = pd.Series(iam, index=aoi.index)\n \n+    return iam\n \n def martin_ruiz(aoi, a_r=0.16):\n     r'''\n@@ -891,3 +903,4 @@ def schlick_diffuse(surface_tilt):\n         cug = pd.Series(cug, surface_tilt.index)\n \n     return cuk, cug\n+\ndiff --git a/pvlib/pvsystem.py b/pvlib/pvsystem.py\nindex bdab5d6..eb1c916 100644\n--- a/pvlib/pvsystem.py\n+++ b/pvlib/pvsystem.py\n@@ -2871,7 +2871,7 @@ def singlediode(photocurrent, saturation_current, resistance_series,\n \n \n def max_power_point(photocurrent, saturation_current, resistance_series,\n-                    resistance_shunt, nNsVth, d2mutau=0, NsVbi=np.Inf,\n+                    resistance_shunt, nNsVth, d2mutau=0, NsVbi=np.inf,\n                     method='brentq'):\n     \"\"\"\n     Given the single diode equation coefficients, calculates the maximum power\ndiff --git a/pvlib/singlediode.py b/pvlib/singlediode.py\nindex 81d6ce3..a9a3cfe 100644\n--- a/pvlib/singlediode.py\n+++ b/pvlib/singlediode.py\n@@ -56,7 +56,7 @@ def estimate_voc(photocurrent, saturation_current, nNsVth):\n \n def bishop88(diode_voltage, photocurrent, saturation_current,\n              resistance_series, resistance_shunt, nNsVth, d2mutau=0,\n-             NsVbi=np.Inf, breakdown_factor=0., breakdown_voltage=-5.5,\n+             NsVbi=np.inf, breakdown_factor=0., breakdown_voltage=-5.5,\n              breakdown_exp=3.28, gradients=False):\n     r\"\"\"\n     Explicit calculation of points on the IV curve described by the single\n@@ -204,7 +204,7 @@ def bishop88(diode_voltage, photocurrent, saturation_current,\n \n def bishop88_i_from_v(voltage, photocurrent, saturation_current,\n                       resistance_series, resistance_shunt, nNsVth,\n-                      d2mutau=0, NsVbi=np.Inf, breakdown_factor=0.,\n+                      d2mutau=0, NsVbi=np.inf, breakdown_factor=0.,\n                       breakdown_voltage=-5.5, breakdown_exp=3.28,\n                       method='newton'):\n     \"\"\"\n@@ -292,7 +292,7 @@ def bishop88_i_from_v(voltage, photocurrent, saturation_current,\n \n def bishop88_v_from_i(current, photocurrent, saturation_current,\n                       resistance_series, resistance_shunt, nNsVth,\n-                      d2mutau=0, NsVbi=np.Inf, breakdown_factor=0.,\n+                      d2mutau=0, NsVbi=np.inf, breakdown_factor=0.,\n                       breakdown_voltage=-5.5, breakdown_exp=3.28,\n                       method='newton'):\n     \"\"\"\n@@ -378,7 +378,7 @@ def bishop88_v_from_i(current, photocurrent, saturation_current,\n \n \n def bishop88_mpp(photocurrent, saturation_current, resistance_series,\n-                 resistance_shunt, nNsVth, d2mutau=0, NsVbi=np.Inf,\n+                 resistance_shunt, nNsVth, d2mutau=0, NsVbi=np.inf,\n                  breakdown_factor=0., breakdown_voltage=-5.5,\n                  breakdown_exp=3.28, method='newton'):\n     \"\"\"\ndiff --git a/pvlib/tests/test_singlediode.py b/pvlib/tests/test_singlediode.py\nindex 4b2a9e9..4d55963 100644\n--- a/pvlib/tests/test_singlediode.py\n+++ b/pvlib/tests/test_singlediode.py\n@@ -331,7 +331,7 @@ def test_pvsyst_recombination_loss(method, poa, temp_cell, expected, tol):\n         # other conditions with breakdown model on and recombination model off\n         (\n             (1.e-4, -5.5, 3.28),\n-            (0., np.Inf),\n+            (0., np.inf),\n             POA,\n             TCELL,\n             {\n"
  },
  "pvlib__pvlib-python-1072": {
    "model_name_or_path": "anthropic/claude-sonnet-4-20250514",
    "instance_id": "pvlib__pvlib-python-1072",
    "model_patch": "diff --git a/pvlib/pvsystem.py b/pvlib/pvsystem.py\nindex fecc930..90e7397 100644\n--- a/pvlib/pvsystem.py\n+++ b/pvlib/pvsystem.py\n@@ -1942,7 +1942,7 @@ def singlediode(photocurrent, saturation_current, resistance_series,\n \n \n def max_power_point(photocurrent, saturation_current, resistance_series,\n-                    resistance_shunt, nNsVth, d2mutau=0, NsVbi=np.Inf,\n+                    resistance_shunt, nNsVth, d2mutau=0, NsVbi=np.inf,\n                     method='brentq'):\n     \"\"\"\n     Given the single diode equation coefficients, calculates the maximum power\n@@ -1989,7 +1989,7 @@ def max_power_point(photocurrent, saturation_current, resistance_series,\n     \"\"\"\n     i_mp, v_mp, p_mp = _singlediode.bishop88_mpp(\n         photocurrent, saturation_current, resistance_series,\n-        resistance_shunt, nNsVth, d2mutau=0, NsVbi=np.Inf,\n+        resistance_shunt, nNsVth, d2mutau=0, NsVbi=np.inf,\n         method=method.lower()\n     )\n     if isinstance(photocurrent, pd.Series):\ndiff --git a/pvlib/singlediode.py b/pvlib/singlediode.py\nindex b800e1c..e056d7d 100644\n--- a/pvlib/singlediode.py\n+++ b/pvlib/singlediode.py\n@@ -56,7 +56,7 @@ def estimate_voc(photocurrent, saturation_current, nNsVth):\n \n def bishop88(diode_voltage, photocurrent, saturation_current,\n              resistance_series, resistance_shunt, nNsVth, d2mutau=0,\n-             NsVbi=np.Inf, breakdown_factor=0., breakdown_voltage=-5.5,\n+             NsVbi=np.inf, breakdown_factor=0., breakdown_voltage=-5.5,\n              breakdown_exp=3.28, gradients=False):\n     r\"\"\"\n     Explicit calculation of points on the IV curve described by the single\n@@ -204,7 +204,7 @@ def bishop88(diode_voltage, photocurrent, saturation_current,\n \n def bishop88_i_from_v(voltage, photocurrent, saturation_current,\n                       resistance_series, resistance_shunt, nNsVth,\n-                      d2mutau=0, NsVbi=np.Inf, breakdown_factor=0.,\n+                      d2mutau=0, NsVbi=np.inf, breakdown_factor=0.,\n                       breakdown_voltage=-5.5, breakdown_exp=3.28,\n                       method='newton'):\n     \"\"\"\n@@ -292,7 +292,7 @@ def bishop88_i_from_v(voltage, photocurrent, saturation_current,\n \n def bishop88_v_from_i(current, photocurrent, saturation_current,\n                       resistance_series, resistance_shunt, nNsVth,\n-                      d2mutau=0, NsVbi=np.Inf, breakdown_factor=0.,\n+                      d2mutau=0, NsVbi=np.inf, breakdown_factor=0.,\n                       breakdown_voltage=-5.5, breakdown_exp=3.28,\n                       method='newton'):\n     \"\"\"\n@@ -378,7 +378,7 @@ def bishop88_v_from_i(current, photocurrent, saturation_current,\n \n \n def bishop88_mpp(photocurrent, saturation_current, resistance_series,\n-                 resistance_shunt, nNsVth, d2mutau=0, NsVbi=np.Inf,\n+                 resistance_shunt, nNsVth, d2mutau=0, NsVbi=np.inf,\n                  breakdown_factor=0., breakdown_voltage=-5.5,\n                  breakdown_exp=3.28, method='newton'):\n     \"\"\"\n@@ -688,3 +688,7 @@ def _pwr_optfcn(df, loc):\n                            df['nNsVth'], df[loc], df['i_0'], df['i_l'])\n \n     return I * df[loc]\n+\n+\n+\n+\ndiff --git a/pvlib/temperature.py b/pvlib/temperature.py\nindex 1d98736..531a346 100644\n--- a/pvlib/temperature.py\n+++ b/pvlib/temperature.py\n@@ -599,7 +599,7 @@ def fuentes(poa_global, temp_air, wind_speed, noct_installed, module_height=5,\n     # n.b. the way Fuentes calculates the first timedelta makes it seem like\n     # the value doesn't matter -- rather than recreate it here, just assume\n     # it's the same as the second timedelta:\n-    timedelta_hours = np.diff(poa_global.index).astype(float) / 1e9 / 60 / 60\n+    timedelta_hours = pd.TimedeltaIndex(np.diff(poa_global.index)).total_seconds() / 3600\n     timedelta_hours = np.append([timedelta_hours[0]], timedelta_hours)\n \n     tamb_array = temp_air + 273.15\n@@ -657,3 +657,4 @@ def fuentes(poa_global, temp_air, wind_speed, noct_installed, module_height=5,\n         sun0 = sun\n \n     return pd.Series(tmod_array - 273.15, index=poa_global.index, name='tmod')\n+\ndiff --git a/pvlib/tests/test_singlediode.py b/pvlib/tests/test_singlediode.py\nindex ee20e48..a5186f4 100644\n--- a/pvlib/tests/test_singlediode.py\n+++ b/pvlib/tests/test_singlediode.py\n@@ -203,7 +203,7 @@ def test_pvsyst_recombination_loss(method, poa, temp_cell, expected, tol):\n         # other conditions with breakdown model on and recombination model off\n         (\n             (1.e-4, -5.5, 3.28),\n-            (0., np.Inf),\n+            (0., np.inf),\n             POA,\n             TCELL,\n             {\ndiff --git a/pvlib/tests/test_temperature.py b/pvlib/tests/test_temperature.py\nindex 245c5d2..8e6a9ac 100644\n--- a/pvlib/tests/test_temperature.py\n+++ b/pvlib/tests/test_temperature.py\n@@ -190,3 +190,43 @@ def test_fuentes(filename, inoct):\n     night_difference = expected_tcell[is_night] - actual_tcell[is_night]\n     assert night_difference.max() < 6\n     assert night_difference.min() > 0\n+\n+\n+def test_fuentes_tz_aware():\n+    # Test that fuentes works with timezone-aware DatetimeIndex\n+    # GitHub issue: timezone-aware inputs cause errors in pandas>=1.0.0\n+    times_naive = pd.date_range('2019-01-01', freq='h', periods=3)\n+    inputs_naive = {\n+        'poa_global': pd.Series(1000, index=times_naive),\n+        'temp_air': pd.Series(20, index=times_naive),\n+        'wind_speed': pd.Series(1, index=times_naive),\n+        'noct_installed': 45\n+    }\n+    \n+    # Test with timezone-aware UTC index\n+    times_utc = times_naive.tz_localize('UTC')\n+    inputs_utc = {\n+        'poa_global': pd.Series(1000, index=times_utc),\n+        'temp_air': pd.Series(20, index=times_utc),\n+        'wind_speed': pd.Series(1, index=times_utc),\n+        'noct_installed': 45\n+    }\n+    \n+    result_naive = temperature.fuentes(**inputs_naive)\n+    result_utc = temperature.fuentes(**inputs_utc)\n+    \n+    # Results should be identical\n+    assert_allclose(result_naive.values, result_utc.values)\n+    \n+    # Test with a different timezone\n+    times_mst = times_naive.tz_localize('US/Mountain')\n+    inputs_mst = {\n+        'poa_global': pd.Series(1000, index=times_mst),\n+        'temp_air': pd.Series(20, index=times_mst),\n+        'wind_speed': pd.Series(1, index=times_mst),\n+        'noct_installed': 45\n+    }\n+    \n+    result_mst = temperature.fuentes(**inputs_mst)\n+    assert_allclose(result_naive.values, result_mst.values)\n+\n"
  }
}