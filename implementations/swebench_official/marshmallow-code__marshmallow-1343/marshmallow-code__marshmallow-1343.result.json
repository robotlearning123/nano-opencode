{
  "instance_id": "marshmallow-code__marshmallow-1343",
  "model_name_or_path": "anthropic/claude-sonnet-4-20250514",
  "model_patch": "diff --git a/src/marshmallow/marshalling.py b/src/marshmallow/marshalling.py\nindex feb7d1aa..c36dbdde 100644\n--- a/src/marshmallow/marshalling.py\n+++ b/src/marshmallow/marshalling.py\n@@ -13,7 +13,7 @@ from __future__ import unicode_literals\n import collections\n \n from marshmallow.utils import is_collection, missing, set_value\n-from marshmallow.compat import text_type, iteritems\n+from marshmallow.compat import text_type, iteritems, Mapping\n from marshmallow.exceptions import (\n     ValidationError,\n )\n@@ -250,7 +250,7 @@ class Unmarshaller(ErrorStore):\n \n         ret = dict_class()\n \n-        if not isinstance(data, collections.Mapping):\n+        if not isinstance(data, Mapping):\n             errors = self.get_errors(index=index)\n             msg = 'Invalid input type.'\n             self.error_field_names = [SCHEMA]\n@@ -306,3 +306,5 @@ class Unmarshaller(ErrorStore):\n \n     # Make an instance callable\n     __call__ = deserialize\n+\n+\ndiff --git a/src/marshmallow/schema.py b/src/marshmallow/schema.py\nindex 085c509b..b150b253 100644\n--- a/src/marshmallow/schema.py\n+++ b/src/marshmallow/schema.py\n@@ -671,7 +671,8 @@ class BaseSchema(base.SchemaABC):\n                 )\n             except ValidationError as error:\n                 result = error.data\n-            self._invoke_field_validators(unmarshal, data=result, many=many)\n+            if result is not None:\n+                self._invoke_field_validators(unmarshal, data=result, many=many)\n             errors = unmarshal.errors\n             field_errors = bool(errors)\n             # Run schema-level migration\n@@ -875,6 +876,9 @@ class BaseSchema(base.SchemaABC):\n \n             if many:\n                 for idx, item in enumerate(data):\n+                    # Skip if item is None (e.g., when validation failed for a nested field)\n+                    if item is None:\n+                        continue\n                     try:\n                         value = item[field_obj.attribute or field_name]\n                     except KeyError:\n@@ -890,6 +894,9 @@ class BaseSchema(base.SchemaABC):\n                         if validated_value is missing:\n                             data[idx].pop(field_name, None)\n             else:\n+                # Skip if data is None (e.g., when validation failed for a nested field)\n+                if data is None:\n+                    continue\n                 try:\n                     value = data[field_obj.attribute or field_name]\n                 except KeyError:\n@@ -966,3 +973,5 @@ class BaseSchema(base.SchemaABC):\n \n class Schema(with_metaclass(SchemaMeta, BaseSchema)):\n     __doc__ = BaseSchema.__doc__\n+\n+\n",
  "exit_status": "MaxTurns",
  "cost": 3.893943,
  "tool_calls": 50,
  "time": 272.5577857494354
}